function [lower, upper, weight] = getWeights(x, y)
    % ----------------------------------------------------------------------- %
    %
    % 该函数返回三个向量：
    % - lower: 在 y 中每个 x 的下界位置。
    % - upper: 在 y 中每个 x 的上界位置。
    % - weight: 下界元素在线性组合中的权重。
    %
    % 输入：
    %   - x: 需要插值的点。
    %   - y: 参考网格（已排序的向量）。
    % 输出：
    %   - lower: 每个 x 对应的下界索引。
    %   - upper: 每个 x 对应的上界索引。
    %   - weight: 下界元素的权重。
    %
    % ----------------------------------------------------------------------- %

    % 找到 y 中每个 x 的上下界
    % 向量长度
    sizX = length(x);  % x 的长度
    sizY = length(y);  % y 的长度

    % 找到每个 x 的下界位置
    [~, ~, lower] = histcounts(x, y);  % 使用 histcounts 找到 x 在 y 中的区间
    % 处理超出 y 边界的情况
    lower(x > y(end)) = sizY - 1;  % 如果 x 大于 y 的最大值，设置为 y 的倒数第二个元素
    lower(x < y(1)) = 1;           % 如果 x 小于 y 的最小值，设置为 y 的第一个元素

    % 对应的上界位置
    upper = lower + 1;  % 上界是下界位置加 1

    % 计算下界元素的权重
    weight = (y(upper) - x) ./ (y(upper) - y(lower));  % 线性插值权重
    % 上界元素的权重是 (1 - weight)
end